'use strict';(function(c){let m=null,p=null,q=null,t=0;const e=a=>document.getElementById(a),h=(a,b=!1)=>{b&&a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();a.returnValue=!1},u=a=>{let b=e(a);b.close?b.close():jQuery("#"+a).modal("hide")},v=a=>{"string"===typeof a&&(a=e(a));a.open?a.open():jQuery(a).modal("show")},x=a=>{const b=new FormData;Object.keys(a).forEach(d=>{"object"!==typeof a[d]?b.append(d,a[d]):b.append(d,JSON.stringify(a[d]))});return b},k=(a,b={},d=()=>{},
f=!1)=>{"object"===typeof b?b instanceof FormData||(b=x(b)):"string"===typeof b&&(b=new URLSearchParams(b));a&&b.set("task",a);fetch(c.V.aBaseURL,{method:"POST",body:b}).then(g=>{if(!g.ok)throw Error(`HTTP ${g.status}`);return f?g.json():g.text()}).then(g=>d(g)).catch(g=>alert("Failure: "+g))};c.newFolder=(a,b)=>{h(a);a=document.forms.un_newfold;document.formvalidator.isValid(a)&&k("EditRaw.saveFolder",new FormData(a),d=>{u("foldercr-modal");d?alert(d):window.location.reload(!0)});return!1};c.saveFolder=
(a,b)=>{h(a);a=document.forms.un_edtfold;document.formvalidator.isValid(a)&&k("EditRaw.saveFolder",new FormData(a),d=>{u("foldered-modal");d?alert(d):window.location.reload(!0)});return!1};c.performSearch=a=>""===a.sterm.value.trim()?(alert(c.L.no_sterm),!1):!0;c.deleteItem=a=>{a=document.forms.actForm;a.task.value="Edit.deleteItem";a.submit();return!1};c.aj_delAttach=(a,b,d)=>{h(a);confirm(c.L.sure_del_att)&&k("EditRaw.detach",{contentID:b,file:d},f=>{f.err?alert(f.err):e("attachments").innerHTML=
f.htm},!0)};c.aj_renAttach=(a,b,d)=>{h(a);(a=prompt(c.L.rename_att,d))&&k("EditRaw.renAttach",{contentID:b,file:d,tofile:a},f=>{f.err?alert(f.err):e("attachments").innerHTML=f.htm},!0)};c.sprintf=(a,...b)=>{for(let d=0;d<b.length;d++)a=a.replace(/%s/,b[d]);return a};c.fup_done=a=>{a||(e("filupld").style.display="none");k("EditRaw.attlist",{contentID:c.V.contentID,inedit:1},b=>{b?e("attachments").innerHTML=b:alert("no data")})};c.getAttach=(a,b,d)=>{h(a,!0);a=c.V.aBaseURL+"&view=atvue&cat="+c.V.itemID+
"|"+c.V.contentID+"|"+b.parentElement.dataset.afile;d?e("dnldf").src=a+"&down=1":window.open(a,"_blank")};c.moveTo=a=>{h(a);m=document.createElement("div");m.className="utildlog";p.appendChild(m);k("EditRaw.cat_hier",{iID:c.V.itemID,pID:c.V.parentID},b=>{b?m.innerHTML=b:alert("no data")});return!1};c.addAttach=a=>{h(a);c.Upld5d.Init();e("filupld").style.display="block"};c.doMove=a=>{a&&k("EditRaw.movitm",{iID:c.V.itemID,pID:e("moveTo").value},b=>{b?alert(b):window.location.reload()});p.removeChild(m);
m=null};c.addRating=(a,b)=>{k("addRating",{rate:a,iID:c.V.itemID},b,!0)};c.toolAct=(a,b)=>{w();if(!a.target.dataset.sure||confirm(c.sprintf(c.L.ru_sure,a.target.dataset.sure)))h(a),k("EditRaw.tool",{mnuact:b,iID:c.V.itemID,cID:c.V.contentID},d=>{d?alert(d):window.location.reload()})};c.toolMenu=a=>{h(a);y("putmenu",a.pageX-60,a.pageY-4)};c.dnldAttach=(a,b)=>{h(a);a=c.V.aBaseURL+"adnld/"+c.V.contentID+"/"+b.rel;b=document.createElement("iframe");b.src=a;b.style.display="none";document.body.appendChild(b)};
c.printNote=(a,b)=>{h(a,!0);window.open(b.href)};c.submitComment=a=>{a.disabled=!0;let b=new FormData(newcmnt);b.append("nid",t);k(null,b,d=>{u("comment-modal");a.disabled=!1;q.innerHTML=d.htm},!0)};c.deleteComment=(a,b)=>{h(a);let d=new FormData;d.append("task","delComment");d.append("cmntid",b);d.append(Joomla.getOptions("csrf.token"),1);k(null,d,f=>{let g=a.target.parentElement.parentElement;g.parentElement.removeChild(g);f.htm&&(q.innerHTML=f.htm)},!0)};c.fetchComments=a=>{a.disabled=!0;let b=
new FormData;b.append("task","getComments");b.append("nid",t);k(null,b,d=>{document.querySelector("#comments-modal .comments").innerHTML=d.htm;d=e("comments-modal");v(d);a.disabled=!1},!0)};c.cmntNote=(a,b)=>{h(a,!0);t=c.V.itemID;q=b;b.children[0].classList.contains("hasem")?c.fetchComments(q):(e("cmnt-text").value="",a=e("comment-modal"),v(a))};let r=null,n=0;const y=(a,b,d,f=3500)=>{c.mcancelclosetime();n&&(n.style.display="none");n=e(a);n.style.display="block";c.mclosetime(f)};c.qView=a=>{let b=
a.parentElement.dataset.href,d=e("qview-modal"),f=d.querySelector(".modal-title");f.innerHTML='<a href="'+b+'">'+a.innerHTML+"</a>";e("qviewdata").innerHTML="Loading...";d.open?d.open():jQuery(d).modal("show");a=new URLSearchParams("qview=1");let g=null;fetch(b+"&format=raw",{method:"POST",body:a}).then(l=>{if(!l.ok)throw Error(`HTTP ${l.status}`);g=l.headers.get("Has-Att");return l.text()}).then(l=>{g&&(f.innerHTML+=" "+c.I.clip);e("qviewdata").innerHTML=l}).catch(l=>alert("Failure: "+l))};c.link2=
a=>{window.location.href=void 0===a.parentElement.dataset.href?a.dataset.href:a.parentElement.dataset.href};const w=()=>{n&&(n.style.display="none")};c.mclosetime=a=>{r=window.setTimeout(w,a)};c.mcancelclosetime=()=>{r&&(window.clearTimeout(r),r=null)};c.watchcmnt=()=>{let a=e("cmntSbb");document.forms.newcmnt.name.value.trim()&&document.forms.newcmnt.cmntext.value.trim()?a.disabled=!1:a.disabled=!0};const z=a=>{let b=a.target;if(b.classList.contains("sure")){a.stopPropagation();a.preventDefault();
if(!confirm(c.sprintf(c.L.ru_sure,b.dataset.suremsg)))return!1;window.location.href=b.href}};document.addEventListener("DOMContentLoaded",()=>{(p=e("container"))&&p.addEventListener("click",z);let a=e("foldercr-modal");a&&a.addEventListener("shown.bs.modal",()=>e("jform_title").focus());(a=e("comment-modal"))&&a.addEventListener("shown.bs.modal",()=>e("cmnt-text").focus())})})(window.UNote=window.UNote||{});
"undefined"!=typeof Joomla&&(Joomla.submitbutton=function(c){if("cancel"==c.split(".")[1])return!0;Joomla.submitform(c)});