/*
	Copyright (C) 2015-2022 RJCreations. All rights reserved.
 @license		GNU General Public License version 3 or later; see LICENSE.txt
*/
'use strict';(function(c){let k=null,m=null;var e=(a,b=!1)=>{b&&a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();a.returnValue=!1},p=a=>{let b=document.getElementById(a);b.close?b.close():jQuery("#"+a).modal("hide")},r=a=>{const b=new FormData;Object.keys(a).forEach(d=>{"object"!==typeof a[d]?b.append(d,a[d]):b.append(d,JSON.stringify(a[d]))});return b},g=(a,b={},d=()=>{},f=!1)=>{"object"===typeof b?b instanceof FormData||(b=r(b)):"string"===typeof b&&(b=new URLSearchParams(b));
a&&b.set("task",a);fetch(c.V.aBaseURL,{method:"POST",body:b}).then(h=>{if(!h.ok)throw Error(`HTTP ${h.status}`);return f?h.json():h.text()}).then(h=>d(h)).catch(h=>alert("Failure: "+h))};c.newFolder=(a,b)=>{e(a);a=document.forms.un_newfold;document.formvalidator.isValid(a)&&g("edit.saveFolder",new FormData(a),d=>{p("foldercr-modal");d?alert(d):window.location.reload(!0)});return!1};c.saveFolder=(a,b)=>{e(a);a=document.forms.un_edtfold;document.formvalidator.isValid(a)&&g("edit.saveFolder",new FormData(a),
d=>{p("foldered-modal");d?alert(d):window.location.reload(!0)});return!1};c.performSearch=a=>{if(""===a.sterm.value.trim())return alert(c.L.no_sterm),!1;a.submit();return!1};c.aj_delAttach=(a,b,d)=>{e(a);confirm(c.L.sure_del_att)&&g("detach",{contentID:b,file:d},f=>{f.err?alert(f.err):document.getElementById("attachments").innerHTML=f.htm},!0)};c.aj_renAttach=(a,b,d)=>{e(a);(a=prompt(c.L.rename_att,d))&&g("renAttach",{contentID:b,file:d,tofile:a},f=>{f.err?alert(f.err):document.getElementById("attachments").innerHTML=
f.htm},!0)};c.sprintf=(a,...b)=>{for(let d=0;d<b.length;d++)a=a.replace(/%s/,b[d]);return a};c.reloadView=()=>{let a=document.getElementById("body");g("ajitem",{iID:c.V.itemID},b=>{b?a.innerHTML=b:alert("no data")})};c.fup_done=a=>{a||(document.getElementById("filupld").style.display="none");g("attlist",{contentID:c.V.contentID},b=>{b?document.getElementById("attachments").innerHTML=b:alert("no data")})};c.getAttach=(a,b,d)=>{e(a,!0);a=b.parentNode.dataset.afile;d?document.getElementById("dnldf").src=
c.V.aBaseURL+"&view=atvue&format=raw&cat="+c.V.contentID+"|"+a+"&down=1":window.location=c.V.aBaseURL+"&view=atvue&format=raw&cat="+c.V.contentID+"|"+a};c.moveTo=a=>{e(a);k=document.createElement("div");k.className="utildlog";m.appendChild(k);g("cat_hier",{iID:c.V.itemID,pID:c.V.parentID},b=>{b?k.innerHTML=b:alert("no data")});return!1};c.addAttach=a=>{e(a);c.Upld5d.Init();document.getElementById("filupld").style.display="block"};c.doMove=a=>{a&&g("movitm",{iID:c.V.itemID,pID:document.getElementById("moveTo").value},
b=>{b?alert(b):window.location.reload()});m.removeChild(k);k=null};c.addRating=(a,b)=>{g("addRating",{rate:a,iID:c.V.itemID},b)};c.toolAct=(a,b)=>{q();if(!a.target.dataset.sure||confirm(c.sprintf(c.L.ru_sure,a.target.dataset.sure)))e(a),g("tool",{mnuact:b,iID:c.V.itemID,cID:c.V.contentID},d=>{d?alert(d):window.location.reload()})};c.toolMenu=a=>{e(a);t("putmenu",a.pageX-60,a.pageY-4)};c.dnldAttach=(a,b)=>{e(a);a=c.V.aBaseURL+"adnld/"+c.V.contentID+"/"+b.rel;b=document.createElement("iframe");b.src=
a;b.style.display="none";document.body.appendChild(b)};c.printNote=(a,b)=>{e(a,!0);window.open(b.href)};let n=null,l=0;var t=(a,b,d,f=3500)=>{c.mcancelclosetime();l&&(l.style.display="none");l=document.getElementById(a);l.style.display="block";c.mclosetime(f)},q=()=>{l&&(l.style.display="none")};c.mclosetime=a=>{n=window.setTimeout(q,a)};c.mcancelclosetime=()=>{n&&(window.clearTimeout(n),n=null)};const u=a=>{let b=a.target;if(b.classList.contains("sure")){a.stopPropagation();a.preventDefault();if(!confirm(c.sprintf(c.L.ru_sure,
b.dataset.suremsg)))return!1;window.location.href=b.href}};document.addEventListener("DOMContentLoaded",()=>{(m=document.getElementById("container"))&&m.addEventListener("click",u)})})(window.UNote=window.UNote||{});"undefined"!=typeof Joomla&&(Joomla.submitbutton=function(c){if("cancel"==c.split(".")[1])return!0;Joomla.submitform(c)});