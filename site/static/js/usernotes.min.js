/*
	Copyright (C) 2015-2022 RJCreations. All rights reserved.
 @license		GNU General Public License version 3 or later; see LICENSE.txt
*/
'use strict';(function(b,f){var g=(a,c=!1)=>{c&&a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();a.returnValue=!1},p=a=>{const c=new FormData;Object.keys(a).forEach(d=>{"object"!==typeof a[d]?c.append(d,a[d]):c.append(d,JSON.stringify(a[d]))});return c},l=(a,c={},d=()=>{},k=!1)=>{"object"===typeof c?c instanceof FormData||(c=p(c)):"string"===typeof c&&(c=new URLSearchParams(c));a&&c.set("task",a);fetch(b.V.aBaseURL,{method:"POST",body:c}).then(e=>{if(!e.ok)throw Error(`HTTP ${e.status}`);
return k?e.json():e.text()}).then(e=>d(e)).catch(e=>alert("Failure: "+e))};b.performSearch=a=>{if(""===f.trim(a.sterm.value))return alert(b.L.no_sterm),!1;a.submit();return!1};b.aj_delAttach=(a,c,d)=>{g(a);let k=b.V.aBaseURL+"&task=";confirm(b.L.sure_del_att)&&l("detach",{contentID:c,file:d},e=>{e?alert(e):f("#attachments").load(k+"attlist&inedit=1",{contentID:c})})};b.aj_renAttach=(a,c,d)=>{g(a);let k=Unote.V.aBaseURL+"&task=";(a=prompt(b.L.rename_att,d))&&l("renAttach",{contentID:c,file:d,tofile:a},
e=>{e?alert(e):f("#attachments").load(k+"attlist&inedit=1",{contentID:c})})};b.sprintf=(a,...c)=>{for(let d=0;d<c.length;d++)a=a.replace(/%s/,c[d]);return a};b.reloadView=()=>{bdiv=document.getElementById("body");l("ajitem",{iID:b.V.itemID},a=>{a?bdiv.innerHTML=a:alert("no data")})};b.fup_done=a=>{a||f("#filupld").hide();f("#attachments").load(b.V.aBaseURL+"&task=attlist",{contentID:b.V.contentID})};b.getAttach=(a,c,d)=>{g(a,!0);a=c.parentNode.dataset.afile;d?document.getElementById("dnldf").src=
b.V.aBaseURL+"&view=atvue&format=raw&cat="+b.V.contentID+"|"+a+"&down=1":window.location=b.V.aBaseURL+"&view=atvue&format=raw&cat="+b.V.contentID+"|"+a};b.moveTo=a=>{g(a);ddlog=document.createElement("div");ddlog.className="utildlog";ddlog.style.top=a.pageY-100+"px";ddlog.style.left=a.pageX+30+"px";document.body.appendChild(ddlog);l("cat_hier",{iID:b.V.itemID,pID:b.V.parentID},c=>{c?ddlog.innerHTML=c:alert("no data")});return!1};b.addAttach=a=>{g(a);b.Upld5d.Init();f("#filupld").show()};b.doMove=
a=>{a&&l("movitm",{iID:b.V.itemID,pID:f("#moveTo").val()},c=>{c?alert(c):window.location.reload()});document.body.removeChild(ddlog)};b.addRating=(a,c)=>{l("addRating",{rate:a,iID:b.V.itemID},c)};b.toolAct=(a,c)=>{n();if(!f(a.srcElement).attr("data-sure")||confirm(b.sprintf(b.L.ru_sure,f(a.srcElement).attr("data-sure"))))g(a),l("tool",{mnuact:c,iID:b.V.itemID,cID:b.V.contentID},d=>{d?alert(d):reloadView()})};b.toolMenu=a=>{g(a);q("putmenu",a.pageX+20,a.pageY-8)};b.dnldAttach=(a,c)=>{g(a);a=b.V.aBaseURL+
"adnld/"+b.V.contentID+"/"+c.rel;c=document.createElement("iframe");c.src=a;c.style.display="none";document.body.appendChild(c)};b.printNote=(a,c)=>{g(a);window.open(c.href)};let m=null,h=0;var q=(a,c,d,k=2500)=>{b.mcancelclosetime();h&&(h.style.display="none");h=document.getElementById(a);h.style.left=c+"px";h.style.top=d+"px";h.style.display="block";b.mclosetime(k)},n=()=>{h&&(h.style.display="none")};b.mclosetime=a=>{m=window.setTimeout(n,a)};b.mcancelclosetime=()=>{m&&(window.clearTimeout(m),
m=null)};f(document).ready(()=>{f(document).on("touchstart touchmove touchend click","a.nav",function(a){console.log(a.type+":"+this.pending);if("touchmove"==a.type)return this.pending&&--this.pending,!0;if(!0!==a.handled)if("click"==a.type||"touchend"==a.type&&this.pending){a.stopPropagation();a.preventDefault();this.pending=0;a.handled=!0;if(f(this).hasClass("sure")&&!confirm(b.sprintf(b.L.ru_sure,f(this).attr("data-suremsg"))))return!1;location.href=this.href}else"touchstart"==a.type&&(this.pending=
10);else return!1})})})(window.UNote=window.UNote||{},jQuery);"undefined"!=typeof Joomla&&(Joomla.submitbutton=function(b){if("cancel"==b.split(".")[1])return!0;Joomla.submitform(b)});