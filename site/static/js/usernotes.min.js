/*
	Copyright (C) 2015-2022 RJCreations. All rights reserved.
 @license		GNU General Public License version 3 or later; see LICENSE.txt
*/
'use strict';(function(c){let l=null,n=null;const e=a=>document.getElementById(a);var f=(a,b=!1)=>{b&&a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();a.returnValue=!1},q=a=>{let b=e(a);b.close?b.close():jQuery("#"+a).modal("hide")},t=a=>{const b=new FormData;Object.keys(a).forEach(d=>{"object"!==typeof a[d]?b.append(d,a[d]):b.append(d,JSON.stringify(a[d]))});return b},h=(a,b={},d=()=>{},g=!1)=>{"object"===typeof b?b instanceof FormData||(b=t(b)):"string"===typeof b&&(b=
new URLSearchParams(b));a&&b.set("task",a);fetch(c.V.aBaseURL,{method:"POST",body:b}).then(k=>{if(!k.ok)throw Error(`HTTP ${k.status}`);return g?k.json():k.text()}).then(k=>d(k)).catch(k=>alert("Failure: "+k))};c.newFolder=(a,b)=>{f(a);a=document.forms.un_newfold;document.formvalidator.isValid(a)&&h("edit.saveFolder",new FormData(a),d=>{q("foldercr-modal");d?alert(d):window.location.reload(!0)});return!1};c.saveFolder=(a,b)=>{f(a);a=document.forms.un_edtfold;document.formvalidator.isValid(a)&&h("edit.saveFolder",
new FormData(a),d=>{q("foldered-modal");d?alert(d):window.location.reload(!0)});return!1};c.performSearch=a=>{if(""===a.sterm.value.trim())return alert(c.L.no_sterm),!1;a.submit();return!1};c.aj_delAttach=(a,b,d)=>{f(a);confirm(c.L.sure_del_att)&&h("detach",{contentID:b,file:d},g=>{g.err?alert(g.err):e("attachments").innerHTML=g.htm},!0)};c.aj_renAttach=(a,b,d)=>{f(a);(a=prompt(c.L.rename_att,d))&&h("renAttach",{contentID:b,file:d,tofile:a},g=>{g.err?alert(g.err):e("attachments").innerHTML=g.htm},
!0)};c.sprintf=(a,...b)=>{for(let d=0;d<b.length;d++)a=a.replace(/%s/,b[d]);return a};c.reloadView=()=>{let a=e("body");h("ajitem",{iID:c.V.itemID},b=>{b?a.innerHTML=b:alert("no data")})};c.fup_done=a=>{a||(e("filupld").style.display="none");h("attlist",{contentID:c.V.contentID},b=>{b?e("attachments").innerHTML=b:alert("no data")})};c.getAttach=(a,b,d)=>{f(a,!0);a=b.parentNode.dataset.afile;d?e("dnldf").src=c.V.aBaseURL+"&view=atvue&format=raw&cat="+c.V.contentID+"|"+a+"&down=1":window.location=c.V.aBaseURL+
"&view=atvue&format=raw&cat="+c.V.contentID+"|"+a};c.moveTo=a=>{f(a);l=document.createElement("div");l.className="utildlog";n.appendChild(l);h("cat_hier",{iID:c.V.itemID,pID:c.V.parentID},b=>{b?l.innerHTML=b:alert("no data")});return!1};c.addAttach=a=>{f(a);c.Upld5d.Init();e("filupld").style.display="block"};c.doMove=a=>{a&&h("movitm",{iID:c.V.itemID,pID:e("moveTo").value},b=>{b?alert(b):window.location.reload()});n.removeChild(l);l=null};c.addRating=(a,b)=>{h("addRating",{rate:a,iID:c.V.itemID},
b)};c.toolAct=(a,b)=>{r();if(!a.target.dataset.sure||confirm(c.sprintf(c.L.ru_sure,a.target.dataset.sure)))f(a),h("tool",{mnuact:b,iID:c.V.itemID,cID:c.V.contentID},d=>{d?alert(d):window.location.reload()})};c.toolMenu=a=>{f(a);u("putmenu",a.pageX-60,a.pageY-4)};c.dnldAttach=(a,b)=>{f(a);a=c.V.aBaseURL+"adnld/"+c.V.contentID+"/"+b.rel;b=document.createElement("iframe");b.src=a;b.style.display="none";document.body.appendChild(b)};c.printNote=(a,b)=>{f(a,!0);window.open(b.href)};let p=null,m=0;var u=
(a,b,d,g=3500)=>{c.mcancelclosetime();m&&(m.style.display="none");m=e(a);m.style.display="block";c.mclosetime(g)},r=()=>{m&&(m.style.display="none")};c.mclosetime=a=>{p=window.setTimeout(r,a)};c.mcancelclosetime=()=>{p&&(window.clearTimeout(p),p=null)};const v=a=>{let b=a.target;if(b.classList.contains("sure")){a.stopPropagation();a.preventDefault();if(!confirm(c.sprintf(c.L.ru_sure,b.dataset.suremsg)))return!1;window.location.href=b.href}};document.addEventListener("DOMContentLoaded",()=>{(n=e("container"))&&
n.addEventListener("click",v);let a=e("foldercr-modal");a&&a.addEventListener("shown.bs.modal",()=>e("jform_title").focus())})})(window.UNote=window.UNote||{});"undefined"!=typeof Joomla&&(Joomla.submitbutton=function(c){if("cancel"==c.split(".")[1])return!0;Joomla.submitform(c)});