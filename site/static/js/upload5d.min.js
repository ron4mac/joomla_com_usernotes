'use strict';UNote.Upld5d=function(){function A(a,b){let c=this;c.show=e=>{c.pb.style.width=100*e+"%";1===e&&(c.pb.className="indeterm")};c.msg=(e,f)=>{c.pbi.innerHTML+="<br />"+e;f&&(c.pbi.className="pbfinf failure",k++)};c.rmov=()=>{c.pbw._ufo=null;l.removeChild(c.pbw);c.fObj=null};let d=m("div","",{class:"pbwrp"});c.pb=d.appendChild(m("div","",{class:b}));c.pbi=d.appendChild(m("div",a.fn+'<i class="fa fa-window-close abortX" aria-hidden="true" onclick="this.parentNode.parentNode._ufo.doAbort(true);"></i>',
{class:"pbfinf"}));l.appendChild(d);c.pbw=d;c.pbw._ufo=a;c.fObj=a;return c}function B(a){let b=this;var c=null;b.fn=a.fileName||a.name;b.lastsz=0;b.fsize=a.size;b.doAbort=function(){b.xhr?b.xhr.abort():b.progress.rmov()};b.xhr=new XMLHttpRequest;if(b.xhr.upload)if(b.xhr._fName=a.name,b.xhr.upload.onabort=function(e){n(b.fsize-b.lastsz)},b.xhr.upload.onloadstart=function(e){b.xhr.upload.onprogress=function(f){f.lengthComputable&&(b.progress.show(f.loaded/f.total),n(f.loaded-b.lastsz),b.lastsz=f.loaded)}},
"object"==typeof fup_ftypes&&0>fup_ftypes.indexOf(a.type)?c=UNote.sprintf(UNote.L.fbadtyp,a.type):a.size>uploadMaxFilesize&&(c=UNote.L.fsz2big),b.progress=new A(b,"normpb"),c)b.progress.msg(c,!0),n(a.size),b.xhr=null,p(!0,"errM");else if(b.xhr.onreadystatechange=function(e){4==b.xhr.readyState&&(200==b.xhr.status?(b.progress.rmov(),q+=b.xhr.responseText):(b.progress.msg(0==b.xhr.status?"-- aborted":b.xhr.status+": "+(b.xhr.statusText||b.xhr.responseText),!0),console.log(b.xhr)),b.xhr=null,p(!0,"rst"))},
b.xhr.open("POST",upldDestURL,!0),fup_payload){c=new FormData;c.append(x,a);for(var d in fup_payload)c.append(d,fup_payload[d]);b.xhr.send(c)}else b.xhr.setRequestHeader("Content-Type","application/octet-stream"),b.xhr.setRequestHeader("X_FILENAME",a.name),b.xhr.send(a)}var y=!1,h,l,r=[],t=0,k=0,u=0,v=0,q="",x="user_file[]";const g=a=>document.getElementById(a),m=(a,b,c)=>{a=document.createElement(a);b&&(a.innerHTML=b);for(let d in c)a.setAttribute(d,c[d]);return a},w=a=>{a.stopPropagation();a.preventDefault();
a.target.className="dragover"==a.type?"hover":""},z=a=>{w(a);a=a.target.files||a.dataTransfer.files;for(var b=0,c;c=a[b];b++)u+=c.size,r.push(c),p(!1,"fsel")},p=(a,b)=>{a&&!--t&&(typeof("function"==UNote.fup_done)&&UNote.fup_done(k),u=v=k=0,q&&console.log(q));r.length&&3>t&&(new B(r.shift()),t++)},n=a=>{h&&(v+=a,h.style.width=100*v/u+"%")};return{Init:()=>{var a=g("upload_field");y?(a.value="",h.style.width=0,g("fprogress").innerHTML=""):(a&&(a.addEventListener("change",z,!1),x=a.name),(new XMLHttpRequest).upload&&
(a=g("dropArea"),a.addEventListener("dragover",w,!1),a.addEventListener("dragleave",w,!1),a.addEventListener("drop",z,!1),a.style.display="block",h=g("totprogress"),l=g("fprogress")),y=!0)}}}();